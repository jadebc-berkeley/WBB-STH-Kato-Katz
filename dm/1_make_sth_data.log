---------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /Users/jadederong/documents/crg/wash-benefits/bangladesh/src/sth/dm/
> 1_make_sth_data.log
  log type:  text
 opened on:  31 Aug 2016, 13:12:38

. 
. *********************************************
. * WASH Benefits Bangladesh
. * STH Kato-Katz analysis
. 
. * Make analysis dataset
. 
. * by Jade
. *********************************************
. clear all

. set more off

. *cd "~/Dropbox/WASHB-Bangladesh-Data/0-Untouched-data/2-STH-kato-katz/"
. 
. 
. *--------------------------------------------
. * Read in KK data 
. *--------------------------------------------
. use "/Users/jadederong/Dropbox/WASHB Parasites/Temp Data/2-WASHB-P-kk-temp.dta"

. 
. * drop spillover children
. drop if personid=="S1"
(2,690 observations deleted)

. 
. *--------------------------------------------
. * Take average of KK egg counts, create binary variables
. *--------------------------------------------
. destring original*, replace
originalAL has all characters numeric; replaced as int
(1 missing value generated)
originalTT has all characters numeric; replaced as int
originalHW has all characters numeric; replaced as int

. 
. *collapse (mean) originalAL originalTT originalHW, by(dataid labdate personid)
. 
. * convert long to wide for duplicate slides
. keep dataid labdate personid slide originalAL originalTT originalHW

. ren originalAL al

. ren originalTT tt

. ren originalHW hw

. 
. destring slide, replace
slide has all characters numeric; replaced as byte

. 
. reshape wide al hw tt, i(dataid personid) j(slide)
(note: j = 1 2)

Data                               long   ->   wide
-----------------------------------------------------------------------------
Number of obs.                    14374   ->    7187
Number of variables                   7   ->       9
j variable (2 values)             slide   ->   (dropped)
xij variables:
                                     al   ->   al1 al2
                                     hw   ->   hw1 hw2
                                     tt   ->   tt1 tt2
-----------------------------------------------------------------------------

. 
. * eggs per gram of stool (EPG) =  sum of the two fecal egg counts
. * from duplicate Kato-Katz thick smears times 12
. * NOT SURE THIS IS RIGHT
. 
. gen alepg = (al1 + al2)*12
(1 missing value generated)

. gen hwepg = (hw1 + hw2)*12

. gen ttepg = (tt1 + tt2)*12

. 
. gen al = (al1>0 | al2>0)

. gen tt = (tt1>0 | tt2>0)

. gen hw = (hw1>0 | hw2>0)

. stop
command stop is unrecognized
r(199);

end of do-file

r(199);

. tab al

         al |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      4,551       63.32       63.32
          1 |      2,636       36.68      100.00
------------+-----------------------------------
      Total |      7,187      100.00

. tab tt

         tt |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      6,685       93.02       93.02
          1 |        502        6.98      100.00
------------+-----------------------------------
      Total |      7,187      100.00

. tab hw

         hw |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      6,633       92.29       92.29
          1 |        554        7.71      100.00
------------+-----------------------------------
      Total |      7,187      100.00

